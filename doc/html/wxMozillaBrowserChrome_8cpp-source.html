<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>wxMozillaBrowserChrome.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.11 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>wxMozillaBrowserChrome.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002  * wxMozillaBrowserChrome
00003  * Copyright 2001 (c) Jeremiah Cornelius McCarthy. All Rights Reserved.
00004  */
00005 <font class="preprocessor">#include &lt;nsIWebBrowserChrome.h&gt;</font>
00006 <font class="preprocessor">#include &lt;nsIWebProgressListener.h&gt;</font>
00007 <font class="preprocessor">#include &lt;nsIInterfaceRequestor.h&gt;</font>
00008 <font class="preprocessor">#include "nsCOMPtr.h"</font>
00009 <font class="preprocessor">#include "nsEmbedAPI.h"</font>
00010 <font class="preprocessor">#include "nsIBaseWindow.h"</font>
00011 <font class="preprocessor">#include "nsIWebBrowser.h"</font>
00012 <font class="preprocessor">#include "nsIWebNavigation.h"</font>
00013 <font class="preprocessor">#include "nsIWindowCreator.h"</font>
00014 <font class="preprocessor">#include "nsString.h"</font>
00015 <font class="preprocessor">#include "nsCWebBrowser.h"</font>
00016 <font class="preprocessor">#include "nsIWebBrowserSetup.h"</font>
00017 <font class="preprocessor">#include "nsIDocShellTreeItem.h"</font>
00018 <font class="preprocessor">#include "wxMozillaBrowserChrome.h"</font>
00019 
00020 NS_IMPL_ADDREF(<a class="code" href="classwxMozillaBrowserChrome.html">wxMozillaBrowserChrome</a>)
00021 NS_IMPL_RELEASE(<a class="code" href="classwxMozillaBrowserChrome.html">wxMozillaBrowserChrome</a>)
00022 
00023 <font class="comment">//NS_IMPL_ISUPPORTS1(wxMozillaBrowserChrome, nsIWebBrowserChrome)</font>
00024 
00025 NS_INTERFACE_MAP_BEGIN(<a class="code" href="classwxMozillaBrowserChrome.html">wxMozillaBrowserChrome</a>)
00026         NS_INTERFACE_MAP_ENTRY_AMBIGUOUS(nsISupports, nsIWebBrowserChrome)
00027         NS_INTERFACE_MAP_ENTRY(nsIInterfaceRequestor)
00028         NS_INTERFACE_MAP_ENTRY(nsIWebBrowserChromeFocus)
00029         NS_INTERFACE_MAP_ENTRY(nsIWebBrowserChrome)
00030         NS_INTERFACE_MAP_ENTRY(nsIEmbeddingSiteWindow)
00031         NS_INTERFACE_MAP_ENTRY(nsIWebProgressListener)
00032 NS_INTERFACE_MAP_END
00033 
<a name="l00043"></a><a class="code" href="classwxMozillaBrowserChrome.html#a0">00043</a> wxMozillaBrowserChrome::wxMozillaBrowserChrome(<a class="code" href="classwxMozillaBrowser.html">wxMozillaBrowser</a> *Moz)<font class="keyword"></font>
00044 {
00045         NS_INIT_REFCNT();
00046         mMoz = Moz;
00047 }
00048 
<a name="l00053"></a><a class="code" href="classwxMozillaBrowserChrome.html#a1">00053</a> <a class="code" href="classwxMozillaBrowserChrome.html#a1">wxMozillaBrowserChrome::~wxMozillaBrowserChrome</a>()<font class="keyword"></font>
00054 {
00055 }
00056 
00067 NS_IMETHODIMP wxMozillaBrowserChrome::GetInterface(<font class="keyword">const</font> nsIID &amp;aIID, <font class="keywordtype">void</font> **aInstancePtr)<font class="keyword"></font>
00068 {
00069         printf(<font class="stringliteral">"GetInterface()"</font>);
00070         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00071 }
00072 
00079 NS_IMETHODIMP wxMozillaBrowserChrome::FocusNextElement()<font class="keyword"></font>
00080 {
00081         printf(<font class="stringliteral">"FocusNextElement()"</font>);
00082         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00083 }
00084 
00091 NS_IMETHODIMP wxMozillaBrowserChrome::FocusPrevElement()<font class="keyword"></font>
00092 {
00093         printf(<font class="stringliteral">"FocusPrevElement()"</font>);
00094         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00095 }
00096 
00097 <font class="comment">/*</font>
00098  * Callback for progress change
00099  *
00100  * @param progress
00101  *      Pointer to &lt;code&gt;nsIWebProgress&lt;/code&gt; class
00102  * @param request
00103  *      Pointer to &lt;code&gt;nsIRequest&lt;/code&gt; class
00104  * @param curSelfProgress
00105  *      Current self progress
00106  * @param maxSelfProgress
00107  *      Maximum self progress   
00108  * @param curTotalProgress
00109  *      Current total progress
00110  * @param maxTotalProgress
00111  *      Maximum total progress
00112  * @return
00113  *      Netscape status
00114  */
00115 NS_IMETHODIMP wxMozillaBrowserChrome::OnProgressChange(nsIWebProgress *progress, nsIRequest *request, PRInt32 curSelfProgress, PRInt32 maxSelfProgress, PRInt32 curTotalProgress, PRInt32 maxTotalProgress)<font class="keyword"></font>
00116 {
00117         printf(<font class="stringliteral">"OnProgressChange()"</font>);
00118         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00119 }
00120 
00135 NS_IMETHODIMP wxMozillaBrowserChrome::OnStateChange(nsIWebProgress *webProgress, nsIRequest *aRequest, PRInt32 progressStateFlags, PRUint32 status)<font class="keyword"></font>
00136 {
00137         printf(<font class="stringliteral">"OnStateChange()"</font>);
00138         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00139 }
00140 
00153 NS_IMETHODIMP wxMozillaBrowserChrome::OnLocationChange(nsIWebProgress *webPRogress, nsIRequest *aRequest, nsIURI *location)<font class="keyword"></font>
00154 {
00155         printf(<font class="stringliteral">"OnLocationChange()"</font>);
00156         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00157 }
00158 
00173 NS_IMETHODIMP wxMozillaBrowserChrome::OnStatusChange(nsIWebProgress *webProgress, nsIRequest *aRequest, nsresult aStatus, <font class="keyword">const</font> PRUnichar *aMEssage)<font class="keyword"></font>
00174 {
00175         printf(<font class="stringliteral">"OnStatusChange()"</font>);
00176         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00177 }
00178 
00191 NS_IMETHODIMP wxMozillaBrowserChrome::OnSecurityChange(nsIWebProgress *aWebProgress, nsIRequest *aRequest, PRInt32 state)<font class="keyword"></font>
00192 {
00193         printf(<font class="stringliteral">"OnSecurityChange()"</font>);
00194         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00195 }
00196 
00207 NS_IMETHODIMP wxMozillaBrowserChrome::SetStatus(PRUint32 statusType, <font class="keyword">const</font> PRUnichar *status)<font class="keyword"></font>
00208 {
00209         <font class="keywordflow">return</font> NS_OK;
00210 }
00211 
00220 NS_IMETHODIMP wxMozillaBrowserChrome::GetWebBrowser(nsIWebBrowser **aWebBrowser)<font class="keyword"></font>
00221 {
00222         printf(<font class="stringliteral">"NI: GetWebBrowser\n"</font>);
00223         NS_ENSURE_ARG_POINTER(aWebBrowser);
00224         NS_ENSURE_TRUE(mWebBrowser, NS_ERROR_NOT_INITIALIZED);
00225         *aWebBrowser = mWebBrowser;
00226         NS_IF_ADDREF(*aWebBrowser);
00227         <font class="keywordflow">return</font> NS_OK;
00228 }
00229 
00238 NS_IMETHODIMP wxMozillaBrowserChrome::SetWebBrowser(nsIWebBrowser * aWebBrowser)<font class="keyword"></font>
00239 {
00240         printf(<font class="stringliteral">"NI: SetWebBrowser\n"</font>);
00241         NS_ENSURE_ARG(aWebBrowser);
00242         NS_ENSURE_TRUE(mWebBrowser, NS_ERROR_NOT_INITIALIZED);
00243         mWebBrowser = aWebBrowser;
00244         <font class="keywordflow">return</font> NS_OK;
00245 }
00246 
00254 NS_IMETHODIMP wxMozillaBrowserChrome::GetChromeFlags(PRUint32 *aChromeFlags)<font class="keyword"></font>
00255 {
00256         <font class="keywordflow">return</font> NS_ERROR_FAILURE;
00257 }
00258 
00267 NS_IMETHODIMP wxMozillaBrowserChrome::SetChromeFlags(PRUint32 aChromeFlags)<font class="keyword"></font>
00268 {
00269         
00270         <font class="keywordflow">return</font> NS_ERROR_FAILURE;
00271 }
00272 
00289 NS_IMETHODIMP wxMozillaBrowserChrome::CreateBrowserWindow(PRUint32 chromeFlags, PRInt32 aX, PRInt32 aY, PRInt32 aCX, PRInt32 aCY, nsIWebBrowser **_retval)<font class="keyword"></font>
00290 {
00291         printf(<font class="stringliteral">"NI: CreateBrowserWindow\n"</font>);
00292         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00293 }
00294 
<a name="l00310"></a><a class="code" href="classwxMozillaBrowserChrome.html#a2">00310</a> NS_IMETHODIMP <a class="code" href="classwxMozillaBrowserChrome.html#a2">wxMozillaBrowserChrome::CreateBrowser</a>(PRInt32 aX, PRInt32 aY, PRInt32 aCX, PRInt32 aCY, nsIWebBrowser **_retval)<font class="keyword"></font>
00311 {
00312         nsresult rv;
00313 
00314         NS_ENSURE_ARG_POINTER(_retval);
00315         *_retval = nsnull;
00316 
00317         <font class="comment">// Create a nsWebBrowser instance</font>
00318         mWebBrowser = do_CreateInstance(NS_WEBBROWSER_CONTRACTID, &amp;rv);
00319         <font class="keywordflow">if</font>(NS_FAILED(rv))
00320                 <font class="keywordflow">return</font> rv;
00321 
00322         <font class="comment">// Give the web browser a pointer to the embedding component</font>
00323         <font class="comment">// which implements the callback interfaces</font>
00324         rv = mWebBrowser-&gt;SetContainerWindow(NS_STATIC_CAST(nsIWebBrowserChrome *, <font class="keyword">this</font>));
00325         <font class="keywordflow">if</font>(NS_FAILED(rv))
00326                 <font class="keywordflow">return</font> rv;
00327         
00328         nsCOMPtr&lt;nsIDocShellTreeItem&gt; dsti = do_QueryInterface(mWebBrowser);
00329         dsti-&gt;SetItemType(nsIDocShellTreeItem::typeContentWrapper);
00330 
00331         mBaseWindow = do_QueryInterface(mWebBrowser);
00332 
00333         <font class="comment">// Initialize the web browser with a native parent window</font>
00334         rv = mBaseWindow-&gt;InitWindow(mMoz-&gt;m_widget, nsnull, 0, 0, 300, 300);
00335         <font class="keywordflow">if</font>(NS_FAILED(rv))
00336                 <font class="keywordflow">return</font> rv;
00337 
00338         <font class="comment">// Create child window for web browser</font>
00339         rv = mBaseWindow-&gt;Create();
00340         <font class="keywordflow">if</font>(NS_FAILED(rv))
00341                 <font class="keywordflow">return</font> rv;
00342 
00343 <font class="comment">//      nsCOMPtr&lt;nsIWebBrowserSetup&gt; webBrowserAsSetup(do_QueryInterface(mWebBrowser));</font>
00344 <font class="comment">//      webBrowserAsSetup-&gt;SetProperty(nsIWebBrowserSetup::SETUP_ALLOW_PLUGINS, PR_FALSE);</font>
00345         <font class="comment">// Disable global history since we don't have profile-relative file locations</font>
00346 <font class="comment">//      webBrowserAsSetup-&gt;SetProperty(nsIWebBrowserSetup::SETUP_USE_GLOBAL_HISTORY, PR_FALSE);</font>
00347         
00348         *_retval = mWebBrowser;
00349         NS_ADDREF(*_retval);
00350 
00351         <font class="keywordflow">return</font> NS_OK;
00352 }
00353 
00360 NS_IMETHODIMP wxMozillaBrowserChrome::DestroyBrowserWindow()<font class="keyword"></font>
00361 {
00362             <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00363 }
00364 
00375 NS_IMETHODIMP wxMozillaBrowserChrome::SizeBrowserTo(PRInt32 aCX, PRInt32 aCY)<font class="keyword"></font>
00376 {
00377         mMoz-&gt;SetSize(aCX, aCY);
00378         
00379         <font class="keywordflow">return</font> NS_OK;
00380 }
00381 
00388 NS_IMETHODIMP wxMozillaBrowserChrome::ShowAsModal()<font class="keyword"></font>
00389 {
00390             <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00391 }
00392 
00401 NS_IMETHODIMP wxMozillaBrowserChrome::IsWindowModal(PRBool *_retval)<font class="keyword"></font>
00402 {
00403         printf(<font class="stringliteral">"NI: IsWindowModal?\n"</font>);
00404         *_retval = PR_FALSE;
00405         <font class="keywordflow">return</font> NS_OK;
00406 }
00407 
00416 NS_IMETHODIMP wxMozillaBrowserChrome::ExitModalEventLoop(nsresult aStatus)<font class="keyword"></font>
00417 {
00418         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00419 }
00420 
00437 NS_IMETHODIMP wxMozillaBrowserChrome::SetDimensions(PRUint32 flags, PRInt32 x, PRInt32 y, PRInt32 cx, PRInt32 cy)<font class="keyword"></font>
00438 {
00439         <font class="keywordflow">if</font>((flags &amp; nsIEmbeddingSiteWindow::DIM_FLAGS_POSITION) &amp;&amp;
00440                 (flags &amp; (nsIEmbeddingSiteWindow::DIM_FLAGS_SIZE_INNER |
00441                            nsIEmbeddingSiteWindow::DIM_FLAGS_SIZE_OUTER)))
00442         {
00443                 <font class="keywordflow">return</font> mBaseWindow-&gt;SetPositionAndSize(x, y, cx, cy, PR_TRUE);
00444         }
00445         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(flags &amp; nsIEmbeddingSiteWindow::DIM_FLAGS_POSITION)
00446         {
00447                 <font class="keywordflow">return</font> mBaseWindow-&gt;SetPosition(x, y);
00448         }
00449         <font class="keywordflow">else</font> <font class="keywordflow">if</font>(flags &amp; (nsIEmbeddingSiteWindow::DIM_FLAGS_SIZE_INNER |
00450                         nsIEmbeddingSiteWindow::DIM_FLAGS_SIZE_OUTER))
00451         {
00452                 <font class="keywordflow">return</font> mBaseWindow-&gt;SetSize(x, y, PR_TRUE);
00453         }
00454         
00455         <font class="keywordflow">return</font> NS_ERROR_INVALID_ARG;
00456 }
00457 
00474 NS_IMETHODIMP wxMozillaBrowserChrome::GetDimensions(PRUint32 flags, PRInt32 *x, PRInt32 *y, PRInt32 *cx, PRInt32 *cy)<font class="keyword"></font>
00475 {
00476         printf(<font class="stringliteral">"NI: GetDimensions()\n"</font>);
00477         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00478 }
00479 
00486 NS_IMETHODIMP wxMozillaBrowserChrome::SetFocus()<font class="keyword"></font>
00487 {
00488         printf(<font class="stringliteral">"NI: SetFocus()\n"</font>);
00489         mBaseWindow-&gt;SetFocus();
00490         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00491 }
00492 
00501 NS_IMETHODIMP wxMozillaBrowserChrome::GetVisibility(PRBool *Vis)<font class="keyword"></font>
00502 {
00503         printf(<font class="stringliteral">"NI: GetVisibility()\n"</font>);
00504         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00505 }
00506 
00515 NS_IMETHODIMP wxMozillaBrowserChrome::SetVisibility(PRBool Vis)<font class="keyword"></font>
00516 {
00517         printf(<font class="stringliteral">"NI: SetVisibility()\n"</font>);
00518         <font class="keywordflow">return</font> NS_ERROR_NOT_IMPLEMENTED;
00519 }
00520 
00529 NS_IMETHODIMP wxMozillaBrowserChrome::GetTitle(PRUnichar **title)<font class="keyword"></font>
00530 {
00531         nsString tmp;
00532 
00533         tmp.AssignWithConversion((<font class="keyword">const</font> <font class="keywordtype">char</font> *)mMoz-&gt;GetTitle());
00534         *title = tmp.ToNewUnicode();
00535         
00536         <font class="keywordflow">return</font> NS_OK;
00537 }
00538 
00547 NS_IMETHODIMP wxMozillaBrowserChrome::SetTitle(<font class="keyword">const</font> PRUnichar *title)<font class="keyword"></font>
00548 {
00549         mMoz-&gt;SetTitle((<font class="keywordtype">char</font> *)title);
00550         <font class="keywordflow">return</font> NS_OK;
00551 }
00552 
00560 NS_IMETHODIMP wxMozillaBrowserChrome::GetSiteWindow(<font class="keywordtype">void</font> **aSiteWindow)<font class="keyword"></font>
00561 {
00562         printf(<font class="stringliteral">"NI: GetSiteWindow()\n"</font>);
00563         NS_ENSURE_ARG_POINTER(aSiteWindow);
00564         *aSiteWindow = mNativeWindow;
00565         <font class="keywordflow">return</font> NS_OK;
00566 }
</pre></div><hr><address><small>Generated on Sat Oct 20 03:19:06 2001 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.11 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
